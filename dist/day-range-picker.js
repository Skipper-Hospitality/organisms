const extend=function(t,e,n){let i,a;for(i in e)a=void 0!==t[i],a&&"object"==typeof e[i]&&null!==e[i]&&void 0===e[i].nodeName?isDate(e[i])?n&&(t[i]=new Date(e[i].getTime())):Array.isArray(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=extend({},e[i],n):!n&&a||(t[i]=e[i]);return t},isDate=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},isHidden=t=>null===t.offsetParent,inBetween=function(t,e,n){return e.getTime()>n.getTime()&&n.getTime()>t.getTime()},addEvent=function(t,e,n,i){window.addEventListener?t.addEventListener(e,n,!!i):t.attachEvent("on"+e,n)},removeEvent=function(t,e,n,i){window.addEventListener?t.removeEventListener(e,n,!!i):t.detachEvent("on"+e,n)},addClass=function(t,e){hasClass(t,e)||(t.className=""===t.className?e:t.className+" "+e)},removeClass=function(t,e){t.className=trim((" "+t.className+" ").replace(" "+e+" "," "))},hasClass=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},trim=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},getDaysInMonth=function(t,e){return[31,isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},setToStartOfDay=function(t){isDate(t)&&t.setHours(0,0,0,0)},compareDates=function(t,e){return t.getTime()===e.getTime()},sto=window.setTimeout,defaults={checkIn:null,checkOut:null,checkInLabel:null,checkOutLabel:null,priceList:null,bound:void 0,position:"bottom left",reposition:!0,showPrice:!1,numberOfMonths:2,startDate:null,endDate:null,format:"YYYY-MM-DD",toString:null,parse:null,minDate:null,maxDate:null,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,dpickerConst:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},onSelect:null,onOpen:null,onClose:null},fireEvent=function(t,e,n){let i;document.createEvent?(i=document.createEvent("HTMLEvents"),i.initEvent(e,!0,!1),i=extend(i,n),t.dispatchEvent(i)):document.createEventObject&&(i=document.createEventObject(),i=extend(i,n),t.fireEvent("on"+e,i))},adjustCalendar=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},renderDayName=function(t,e,n){for(;e>=7;)e-=7;return n?t.dpickerConst.weekdaysShort[e]:t.dpickerConst.weekdays[e]},renderInputLabel=function(t,e){return e.getDate()+"<small>"+t.dpickerConst.monthsShort[e.getMonth()]+"</small>"},renderDay=function(t){let e=[],n="false";if(t.isEmpty)return'<td class="is-empty"></td>';t.isToday&&e.push("is-today"),(t.isFirst||t.isEnd)&&(e.push("is-selected"),n="true"),t.isInBetween&&(e.push("is-inBetween"),n="true"),t.isDisabled&&e.push("is-disabled");let i=t.showPrice?`<div class="day-box"><div class="day-date">${t.day}</div><div class="day-price">${t.price?"$"+t.price:"--"}</div></div>`:`${t.day}`;return'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="daypicker-button daypicker-day" type="button" data-daypicker-year="'+t.year+'" data-daypicker-month="'+t.month+'" data-daypicker-day="'+t.day+'">'+i+"</button></td>"},renderRow=function(t){return`<tr class="daypicker-row">${t.join("")}</tr>`},renderBody=function(t){return"<tbody>"+t.join("")+"</tbody>"},renderHead=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><span title="'+renderDayName(t,e)+'">'+renderDayName(t,e,!0)+"</span></th>");return`<thead><tr class="days-name">${n.join("")}</tr></thead>`},renderTitle=function(t,e,n,i,a){let s=t._o,o=!0,r=!0,h=`<div id="${a}" class="daypicker-title" role="heading" aria-live="assertive">`;return h+=`<div class="daypicker-label"> ${s.dpickerConst.months[i]} ${n} </div>`,(s.minYear>n||s.minMonth>=i)&&(o=!1),0===e&&o&&(h+=`<button class="daypicker-prev" type="button">${s.dpickerConst.previousMonth}</button>`),(s.maxYear<n||s.maxMonth<=i)&&(r=!1),e===t._o.numberOfMonths-1&&r&&(h+=`<button class="daypicker-next" type="button">${s.dpickerConst.nextMonth}</button>`),h+"</div>"},renderTable=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="daypicker-table" role="grid" aria-labelledby="'+n+'">'+renderHead(t)+("<tbody>"+e.join("")+"</tbody></table>")};let DayRangePicker=function(t){let e=this,n=e.config(t);function i(t){e.setDate(new Date(t.getAttribute("data-daypicker-year"),t.getAttribute("data-daypicker-month"),t.getAttribute("data-daypicker-day"))),n.bound&&e._d&&e._d.start&&e._d.end&&sto((function(){e.hide()}),500)}this.goToNextMonth=function(){e.nextMonth()},this.goToPrevMonth=function(){e.prevMonth()},this.selectStartDate=t=>{e.setStartDate(t)},this.selectEndDate=t=>{e.setEndDate(t)},this.getCurrentStartDate=()=>this._d.start&&isDate(this._d.start)?this.format(n.format,"start"):"",this.getCurrentEndDate=()=>this._d.end&&isDate(this._d.end)?this.format(n.format,"end"):"",this.getCurrentDateRange=()=>this._o.checkIn.value+" - "+this._o.checkOut.value,this.setDateRange=(t,n)=>{e.setStartDate(t),e.setEndDate(n)},this.setPriceList=t=>{n.priceList={},t.length>0&&t.forEach((t=>{let e=new Date(t.date),i=e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate();n.priceList[i]=t.price}))},e._onMouseDown=function(t){if(!e._view)return;let n=(t=t||window.event).target||t.srcElement;if(n){if(hasClass(n,"daypicker-button")&&!hasClass(n,"is-empty"))i(n);else if(hasClass(n,"day-box")){i(n.parentNode)}else if(hasClass(n,"day-date")||hasClass(n,"day-price")){i(n.parentNode.parentNode)}else hasClass(n,"daypicker-prev")?e.prevMonth():hasClass(n,"daypicker-next")&&e.nextMonth();if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._parseFieldValue=function(){return n.parse?n.parse(n.checkIn.value,n.format):new Date(Date.parse(n.checkIn.value))},e._onInputClick=function(){e.show()},e._onClick=function(t){let i=(t=t||window.event).target||t.srcElement,a=i;if(i){do{if(hasClass(a,"daypicker-range")||a===n.trigger)return}while(a=a.parentNode);e._view&&i!==n.checkIn&&i!==n.checkOut&&e.hide()}},e.el=document.createElement("div"),e.el.className="daypicker-range",addEvent(e.el,"mousedown",e._onMouseDown,!0),addEvent(e.el,"touchend",e._onMouseDown,!0),n.checkIn&&(n.bound?document.body.appendChild(e.el):n.checkIn.parentNode.insertBefore(e.el,n.checkIn.nextSibling));let a=new Date;isDate(n.minDate)&&n.minDate.getTime()>a.getTime()?a=n.minDate:isDate(n.maxDate)&&n.maxDate.getTime()<a.getTime()&&(a=n.maxDate),e.gotoDate(a),n.bound&&(this.hide(),e.el.className+=" is-bound",addEvent(n.checkIn,"click",e._onInputClick),addEvent(n.checkOut,"click",e._onInputClick))};DayRangePicker.prototype={config:function(t){this._o||(this._o=extend({},defaults,!0));let e=extend(this._o,t,!0);return e.checkIn=e.checkIn&&e.checkIn.nodeName?e.checkIn:null,e.bound=!!(void 0!==e.bound?e.checkIn&&e.bound:e.checkIn),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.checkIn,isDate(e.minDate)||(e.minDate=!1),isDate(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),isDate(this._o.startDate)&&this.setStartDate(this._o.startDate),isDate(this._o.endDate)&&this.setEndDate(this._o.endDate),e},toString:function(t){return t=t||this._o.format,isDate(this._d.start)?this._o.toString?this._o.toString(this._d.start,t):this._d&&this._d.start&&this._d.end?this.format(t,"start")+" - "+this.format(t,"end"):this._d&&this._d.start?this.format(t,"start"):"":""},getStartDate:function(t){return t=t||this._o.format,isDate(this._d.start)&&this._d&&this._d.start?this.format(t,"start"):""},getStartDateLabel:function(){return this._d&&this._d.start?renderInputLabel(this._o,this._d.start):""},getEndDate:function(t){return t=t||this._o.format,isDate(this._d.end)&&this._d&&this._d.end?this.format(t,"end"):""},getEndDateLabel:function(){return this._d&&this._d.end?renderInputLabel(this._o,this._d.end):""},format:function(t,e){let n={"M+":this._d[e].getMonth()+1,"d+":this._d[e].getDate(),"D+":this._d[e].getDate(),"h+":this._d[e].getHours(),"m+":this._d[e].getMinutes(),"s+":this._d[e].getSeconds(),"q+":Math.floor((this._d.start.getMonth()+3)/3),S:this._d.start.getMilliseconds()};/((Y+)|(y+))/.test(t)&&(t=t.replace(RegExp.$1,(this._d[e].getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in n)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[e]:("00"+n[e]).substr((""+n[e]).length)));return t},getDate:function(){return isDate(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.checkIn&&(this._o.checkIn.value="",fireEvent(this._o.checkIn,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!isDate(t))return;let n=this._o.minDate,i=this._o.maxDate;isDate(n)&&t<n?t=n:isDate(i)&&t>i&&(t=i),this._d&&this._d.start&&this._d.end&&(this._d=null);let a=this._d&&this._d.start?"end":"start";if("start"===a&&(this._d={}),this._d[a]=new Date(t.getTime()),setToStartOfDay(this._d[a]),this.gotoDate(this._d[[a]]),"end"==a&&this._d.start.getTime()>this._d.end.getTime()){let t=this._d.start;this._d.start=this._d.end,this._d.end=t}this._o.checkIn&&(this._o.checkIn.value=this.getStartDate(),this._o.checkInLabel&&(this._o.checkInLabel.innerHTML=this.getStartDateLabel()),fireEvent(this._o.checkIn,"change",{firedBy:this})),this._o.checkOut&&(this._o.checkOut.value=this.getEndDate(),this._o.checkOutLabel&&(this._o.checkOutLabel.innerHTML=this.getEndDateLabel()),fireEvent(this._o.checkOut,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},setStartDate:function(t){if(!t)return;if("string"==typeof t&&(t=new Date(Date.parse(t))),!isDate(t))return;let e=this._o.minDate;isDate(e)&&t<e&&(t=e);let n="start";this._d||(this._d={}),this._d[n]=new Date(t.getTime()),setToStartOfDay(this._d[n]),this.gotoDate(this._d[[n]]),this._o.checkIn&&(this._o.checkIn.value=this.getStartDate(),this._o.checkInLabel&&(this._o.checkInLabel.innerHTML=this.getStartDateLabel()),fireEvent(this._o.checkIn,"change",{firedBy:this}))},setEndDate:function(t){if(!t)return;if("string"==typeof t&&(t=new Date(Date.parse(t))),!isDate(t))return;let e=this._o.maxDate;isDate(e)&&t>e&&(t=e);let n="end";this._d||(this._d={}),this._d.end=new Date(t.getTime()),setToStartOfDay(this._d.end),this.gotoDate(this._d[[n]]),this._o.checkOut&&(this._o.checkOut.value=this.getEndDate(),this._o.checkOutLabel&&(this._o.checkOutLabel.innerHTML=this.getEndDateLabel()),fireEvent(this._o.checkOut,"change",{firedBy:this}))},gotoDate:function(t){let e=!0;if(isDate(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),a=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=a<n.getTime()||i.getTime()<a}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}]),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=adjustCalendar({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},setMinDate:function(t){t instanceof Date?(setToStartOfDay(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=defaults.minDate,this._o.minYear=defaults.minYear,this._o.minMonth=defaults.minMonth,this._o.startRange=defaults.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(setToStartOfDay(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=defaults.maxDate,this._o.maxYear=defaults.maxYear,this._o.maxMonth=defaults.maxMonth,this._o.endRange=defaults.endRange),this.draw()},draw:function(t){if(!this._view&&!t)return;let e,n=this._o,i="";for(let t=0;t<n.numberOfMonths;t++)e="daypicker-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),i+='<div class="daypicker-lendar">'+renderTitle(this,t,this.calendars[t].year,this.calendars[t].month,e)+this.render(this.calendars[t].year,this.calendars[t].month,e)+"</div>";this.el.innerHTML=i,n.bound&&"hidden"!==n.checkIn.type&&sto((function(){n.trigger.focus()}),200)},adjustPosition:function(){let t,e,n,i,a,s,o,r,h,d,c,l;if(this.el.style.position="absolute",t=this._o.trigger,e=t,n=this.el.offsetWidth,i=this.el.offsetHeight,a=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight,o=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,c=!0,l=!0,isHidden(this._o.checkIn)||"function"!=typeof this._o.checkIn.getBoundingClientRect)if(isHidden(this._o.checkInLabel)||"function"!=typeof this._o.checkInLabel.getBoundingClientRect)for(r=e.offsetLeft,h=e.offsetTop+e.offsetHeight;e=e.offsetParent;)r+=e.offsetLeft,h+=e.offsetTop;else d=this._o.checkInLabel.getBoundingClientRect(),r=d.left+window.pageXOffset,h=d.bottom+window.pageYOffset;else d=this._o.checkIn.getBoundingClientRect(),r=d.left+window.pageXOffset,h=d.bottom+window.pageYOffset;(this._o.reposition&&r+n>a||this._o.position.indexOf("right")>-1&&r-n+t.offsetWidth>0)&&(r=r-n+t.offsetWidth,c=!1),(this._o.reposition&&h+i>s+o||this._o.position.indexOf("top")>-1&&h-i-t.offsetHeight>0)&&(h=h-i-t.offsetHeight,l=!1),r<0&&(r=0),h<0&&(h=0),this.el.style.left=r+"px",this.el.style.top=h+"px",addClass(this.el,c?"left-aligned":"right-aligned"),addClass(this.el,l?"bottom-aligned":"top-aligned"),removeClass(this.el,c?"right-aligned":"left-aligned"),removeClass(this.el,l?"top-aligned":"bottom-aligned")},render:function(t,e,n){let i=this._o,a=new Date,s=getDaysInMonth(t,e),o=new Date(t,e,1).getDay(),r=[],h=[];setToStartOfDay(a);let d=0===e?11:e-1,c=11===e?0:e+1,l=0===e?t-1:t,u=11===e?t+1:t,f=getDaysInMonth(l,d),m=s+o;m+=7-m%7;for(let n=0,p=0;n<m;n++){let m=new Date(t,e,n-o+1),y=!!(this._d&&this._d.start&&isDate(this._d.start))&&compareDates(m,this._d.start),k=!!(this._d&&this._d.end&&isDate(this._d.end))&&compareDates(m,this._d.end),b=!!(this._d&&this._d.start&&this._d.end)&&(_=this._d.start,D=this._d.end,g=m,D.getTime()>g.getTime()&&g.getTime()>_.getTime()),v=compareDates(m,a),w=n<o||n>=s+o,M=n-o+1,x=e,E=t,T=i.minDate&&m<i.minDate||i.maxDate&&m>i.maxDate;w&&(n<o?(M=f+M,x=d,E=l):(M-=s,x=c,E=u));let I=E+"_"+x+"_"+M,C=i.priceList[I]?i.priceList[I]:null,L={day:M,month:x,year:E,isFirst:y,isEnd:k,isInBetween:b,isToday:v,isEmpty:w,isDisabled:T,showPrice:i.showPrice,price:C,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths};h.push(renderDay(L)),7==++p&&(r.push(renderRow(h)),h=[],p=0)}var _,D,g;return renderTable(i,r,n)},isVisible:function(){return this._view},show:function(){this.isVisible()||(this._view=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(document,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._view;var e,n,i,a;!1!==t&&(this._o.bound&&(e=document,n="click",i=this._onClick,window.addEventListener?e.removeEventListener(n,i,!!a):e.detachEvent("on"+n,i)),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",addClass(this.el,"is-hidden"),this._view=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))}};export{DayRangePicker};